(()=>{"use strict";const a=(a,...e)=>{const t=document.createElement(a);return e.forEach((a=>t.classList.add(a))),t},e=(a,e)=>Math.round(Math.random()*(e-a)+a),t=a=>JSON.parse(localStorage.getItem(`memoryGame_${a}`))||[],s=document.querySelector(".game-board"),r=document.querySelector(".level-container"),c=r.querySelector(".level-title"),n=document.querySelector(".game-button__reset"),i=document.querySelector(".game-timer"),l=i.querySelector(".minutes"),d=i.querySelector(".seconds"),o=document.querySelector(".game-result"),g=o.querySelector(".click-count");let m=t(c.dataset.level),u=!1,f=[];const p={easy:{0:"url('./assets/img/cards/farm/0.png')",1:"url('./assets/img/cards/farm/1.png')",2:"url('./assets/img/cards/farm/2.png')",3:"url('./assets/img/cards/farm/3.png')",4:"url('./assets/img/cards/farm/4.png')",5:"url('./assets/img/cards/farm/5.png')",6:"url('./assets/img/cards/farm/6.png')",7:"url('./assets/img/cards/farm/7.png')",8:"url('./assets/img/cards/farm/8.png')",9:"url('./assets/img/cards/farm/9.png')",10:"url('./assets/img/cards/farm/10.png')",11:"url('./assets/img/cards/farm/11.png')",12:"url('./assets/img/cards/farm/12.png')",13:"url('./assets/img/cards/farm/13.png')",14:"url('./assets/img/cards/farm/14.png')"},hard:{0:"url('./assets/img/cards/hiragana/0.png')",1:"url('./assets/img/cards/hiragana/1.png')",2:"url('./assets/img/cards/hiragana/2.png')",3:"url('./assets/img/cards/hiragana/3.png')",4:"url('./assets/img/cards/hiragana/4.png')",5:"url('./assets/img/cards/hiragana/5.png')",6:"url('./assets/img/cards/hiragana/6.png')",7:"url('./assets/img/cards/hiragana/7.png')",8:"url('./assets/img/cards/hiragana/8.png')",9:"url('./assets/img/cards/hiragana/9.png')",10:"url('./assets/img/cards/hiragana/10.png')",11:"url('./assets/img/cards/hiragana/11.png')",12:"url('./assets/img/cards/hiragana/12.png')",13:"url('./assets/img/cards/hiragana/13.png')",14:"url('./assets/img/cards/hiragana/14.png')"}};let h,v,y,_={timer:0,isPlaying:!1,imageInGame:[],cardPairs:{},click:0,level:""};function L(){o.classList.remove("finished"),s.textContent="",_={isPlaying:!1,imageInGame:[],cardPairs:{},click:0,level:c.dataset.level},_.timer=0,clearInterval(h),l.textContent="00",d.textContent="00",g.textContent=_.click;for(let a=0;a<30;a++){const e=P(a);s.append(e)}m=document.querySelectorAll(".card");for(let a=0;a<Math.ceil(15);a++)S(q(p[_.level]));s.addEventListener("click",k)}function k(a){if(a.target.classList.contains("card__face_front")){_.isPlaying||(h=setInterval((()=>{_.timer++;const[a,e]=(a=>{const e=Math.floor(a/60),t=a-60*e;return[`${Math.floor(e/10)}${Math.floor(e%10)}`,`${Math.floor(t/10)}${Math.floor(t%10)}`]})(_.timer);l.textContent=a,d.textContent=e}),1e3)),_.isPlaying=!0;const c=a.target.closest(".card");c.classList.add("flip"),g.textContent=++_.click,_.click%2==1&&(v=c,y=null),_.click%2==0&&(y=c,function(a,e){if(_.cardPairs[a]==e||_.cardPairs[e]==a)return!0}(v.dataset.count,y.dataset.count)?(v.classList.add("flip-fixed"),y.classList.add("flip-fixed"),e=v.dataset.count,r=y.dataset.count,_.cardPairs[e]&&delete _.cardPairs[e],_.cardPairs[r]&&delete _.cardPairs[r],v=null,y=null,0===Object.values(_.cardPairs).length&&(o.classList.add("finished"),function(a,e,s){f=t(s),f.push([a,e]);const r=f.sort(((a,e)=>a[0]>e[0]||a[0]==e[0]&&a[1]>e[1]?1:-1));localStorage.setItem(`memoryGame_${s}`,JSON.stringify(r.slice(0,10)))}(_.click,_.timer,_.level),clearInterval(h))):(s.classList.add("disabled"),setTimeout((()=>{m.forEach((a=>{a.classList.contains("flip-fixed")||a.classList.remove("flip")}))}),800),setTimeout((()=>{v=null,y=null,s.classList.remove("disabled")}),1e3)))}var e,r}function P(e){const t=a("div","card"),s=a("div","card__face","card__face_front"),r=a("div","card__face","card__face_back");return t.append(s),t.append(r),t.dataset.count=e,t}function S(a){const e=x();_.cardPairs[e]=null;const t=x();_.cardPairs[e]=t,M(e,a),M(t,a)}function x(){let a=e(0,29);for(;Object.keys(_.cardPairs).includes(a.toString())||Object.values(_.cardPairs).includes(a);)a=e(0,29);return a}function M(a,e){m[a].querySelector(".card__face_back").style.backgroundImage=e}function q(a){let e=Math.floor(15*Math.random());for(;_.imageInGame.includes(e);)e=Math.floor(15*Math.random());return _.imageInGame.push(e),a[e]}function b(a){a.target.dataset.level||(u=!1,r.classList.remove("active"),document.removeEventListener("click",b))}L(),n.addEventListener("click",L),r.addEventListener("click",(a=>{const e=a.target;r.classList.toggle("active"),u?(u=!1,document.removeEventListener("click",b),c.textContent=e.textContent,c.dataset.level=e.dataset.level,L()):(u=!0,document.addEventListener("click",b))}))})();